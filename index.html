<script>
        const N8N_URL = 'https://apps.villaitue.cl/webhook-test/autoservicio';
        const viewer = document.getElementById('viewer');
        
        // --- 1. FONDO DINÁMICO (PORTAL) ---
        const fotosPortal = [
            'https://vsn47925-tech.github.io/img/servicio/portal-entrada.jpg',
            'https://vsn47925-tech.github.io/img/servicio/portal-recep.jpg',
            'https://vsn47925-tech.github.io/img/servicio/portal-villa.jpg',
            'https://vsn47925-tech.github.io/img/servicio/portal-volcan.jpg'
        ];
        let currentPortal = 0;
        
        // Crear capa de fondo
        document.body.style.backgroundImage = `linear-gradient(rgba(15, 23, 42, 0.8), rgba(15, 23, 42, 0.8)), url('${fotosPortal[0]}')`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundPosition = 'center';
        document.body.style.transition = 'background-image 2s ease-in-out';

        setInterval(() => {
            currentPortal = (currentPortal + 1) % fotosPortal.length;
            document.body.style.backgroundImage = `linear-gradient(rgba(15, 23, 42, 0.8), rgba(15, 23, 42, 0.8)), url('${fotosPortal[currentPortal]}')`;
        }, 10000); // Cambia cada 10 segundos

        // --- 2. LÓGICA DE RESPUESTA (CARRUSEL) ---
        const renderizar = (data) => {
            if (data.imagenes && data.imagenes.length > 0) {
                return `
                <div class="flex flex-col gap-4 animate-in zoom-in duration-500 max-w-md w-full">
                    <div class="relative overflow-hidden rounded-3xl shadow-2xl border-4 border-white/10 bg-slate-900">
                        <div class="flex overflow-x-auto snap-x snap-mandatory scrollbar-hide" id="slider">
                            ${data.imagenes.map(img => `<div class="snap-center shrink-0 w-full h-72"><img src="${img}" class="w-full h-full object-cover"></div>`).join('')}
                        </div>
                    </div>
                    <div class="bg-slate-900/90 backdrop-blur-md p-6 rounded-3xl border border-white/10 text-left">
                        <h3 class="text-2xl font-bold text-blue-400">${data.titulo}</h3>
                        <p class="text-slate-200 mt-2">${data.descripcion || ''}</p>
                        ${data.precio ? `<p class="text-xl font-black text-white mt-4">${data.precio}</p>` : ''}
                    </div>
                </div>`;
            }
            return `<div class="bg-slate-900/80 p-8 rounded-3xl border border-white/10 max-w-lg text-2xl text-white">${data.output}</div>`;
        };

        // ... (Resto del código de reconocimiento y voz igual al anterior) ...
    </script>
